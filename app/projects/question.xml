<Page navigatingTo="onNavigatingTo" xmlns="http://schemas.nativescript.org/tns.xsd">

  <ActionBar>
    <Label class="ibm7 h2" text="List of Questions" />
  </ActionBar>

  <GridLayout rows="auto, *, auto" columns="*">

    <!-- Search bar -->
    <SearchBar row="0"
               hint="Quick search..."
               text="{{ searchQuery }}"
               submit="onSearchSubmit"
               clear="onSearchClear"
               textChange="onSearchTextChanged" />

    <!-- List view -->
    <!-- CHANGE: bind to items (the paged list), not activeQuestions -->
    <ListView row="1" items="{{ items }}" itemTap="onItemTap">
      <ListView.itemTemplate>
        <GridLayout class="ibm5" padding="16" rows="*,*" columns="20, auto, *, 60">
          <ContentView row="0" col="0" width="20" height="20" borderRadius="10"
            backgroundColor="{{ type === 'html' ? '#65adf1' : '#e0e0e0' }}" />
          <Label text="{{ id }}" row="0" col="1" textWrap="true" marginLeft="8" />
          <Label text="{{ name }}" row="0" col="2" textWrap="true" textTransform="uppercase"
            marginLeft="8" visibility="{{ type === 'html' ? 'collapse' : 'visible' }}" />
          <Label text="{{ name }}" row="0" col="2" colSpan="2" textWrap="true" marginLeft="8"
            visibility="{{ type === 'html' ? 'visible' : 'collapse' }}" />
          <Label text="Section" row="0" col="3" color="red" textTransform="uppercase"
            visibility="{{ type === 'html' ? 'visible' : 'collapse' }}" />
          <Label class="ibm6" text="{{ title === null ? '' : title }}" row="1" col="0" colSpan="4"
            textWrap="true" marginLeft="8" />
        </GridLayout>
      </ListView.itemTemplate>
    </ListView>

    <!-- Pagination -->
    <DockLayout row="2" class="pagination-container" stretchLastChild="true">
      <GridLayout rows="*, *" columns="auto, *, auto" dock="bottom">
        <Button col="0" rowspan="2" class="btn btn-primary" text="<< Prev"
                tap="{{ goPrev }}" isEnabled="{{ currentPage > 1 }}" />
        <StackLayout col="1" row="0" orientation="horizontal" horizontalAlignment="center">
          <Label class="ibm4" text="Total: " />
          <Label class="ibm6" text="{{ totalItems }}" />
          <Label class="ibm4" text=" - Page " />
          <Label class="ibm6" text="{{ currentPage }}" />
          <Label class="ibm4" text=" / " />
          <Label class="ibm6" text="{{ totalPages }}" />
        </StackLayout>
        <StackLayout col="1" row="1" orientation="horizontal" horizontalAlignment="center">
          <Label class="ibm4" text="Showing " />
          <Label class="ibm6" text="{{ startItem }}" />
          <Label class="ibm4" text=" to " />
          <Label class="ibm6" text="{{ stopItem }}" />
        </StackLayout>
        <Button col="2" rowspan="2" class="btn btn-primary" text="Next >>"
                tap="{{ goNext }}" isEnabled="{{ currentPage < totalPages }}" />
      </GridLayout>
    </DockLayout>

  </GridLayout>
</Page>